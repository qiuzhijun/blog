<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:fragment="head(title)">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title th:replace="${title}">fragment</title>
    <link rel="stylesheet" th:href="@{/Semantic-UI-2.4.1/dist/semantic.min.css}">
    <link rel="stylesheet" th:href="@{/css/mycss.css}">
    <link rel="stylesheet" th:href="@{/css/typo.css}">
    <link rel="stylesheet" th:href="@{/lib/tocbot/tocbot.css}">
    <link href="https://cdn.jsdelivr.net/npm/animate.css@3.5.1" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" th:href="@{/lib/prism/prism.css}">

    <style type="text/css">
        body {
            background: #0C1021;
        }
        .right-last{
            position: absolute;
            right:-100px;
            top:2%;
        }

    </style>
</head>

<body>
<nav th:fragment="menu(n)" id="back-top" class="ui inverted m_shadow_small attached segment m_padded_tb_mini">
    <!--创建一个容器-->
    <div class="ui container">
        <!--创建次级菜单-->
        <div class="ui stackable menu inverted secondary">
            <!--创建蓝绿色的头项-->
            <h2 class="ui header item m_t_color_name">Caelum_Blog</h2>
            <!--创建普通项-->
            <a class="m_item m_mobile_hide item" th:classappend="${n==1} ? 'active'" th:href="@{/index}"><i
                    class="small home icon"></i>首页</a>
            <a class="m_item m_mobile_hide item" th:classappend="${n==2} ? 'active'" th:href="@{/types/-1}"><i
                    class="small idea icon"></i>分类</a>
            <a class="m_item m_mobile_hide item" th:classappend="${n==3} ? 'active'" th:href="@{/tags/-1}"><i
                    class="small tags icon"></i>标签</a>
            <a class="m_item m_mobile_hide item" th:classappend="${n==4} ? 'active'" th:href="@{/archives}"><i
                    class="small clone icon"></i>归档</a>
            <a class="m_item m_mobile_hide item" th:classappend="${n==5} ? 'active'" th:href="@{/profile}"><i
                    class="small music  icon"></i>网抑云</a>
            <a class="m_item m_mobile_hide item" th:classappend="${n==6} ? 'active'" th:href="@{/message}"> <i
                    class="small archive icon"></i>留言板</a>
            <a class="m_item m_mobile_hide item close-light"><i class="small lightbulb outline icon"></i>关灯</a>

            <!--创建右边项-->
            <div class="item">
                <form th:action="@{/search}" method="post" name="search" target="_blank">
                <!--创建搜索，透明显示-->
                <div  class="m_mobile_hide ui icon transparent inverted input">
                    <input name="query"  type="text" th:value="${query}" placeholder="搜索……">
                    <!--在内加入搜索图标-->
                    <i onclick="document.forms['search'].submit()" class="search link icon"></i>
                </div>
                </form>
<form id="success" th:action="@{/admin/blogs}"></form>

            <div class="right-last m-item m-mobile-hide menu">
                <div th:if="${session.user} != null" class="ui right-last  dropdown  item">
                    <div  class="text">
                        <img class="ui avatar image"  th:src='@{${session.user.avatar}}' >
                        <span th:text="${session.user.nickname}"></span>
                    </div>
                    <i class="dropdown icon"></i>
                    <div class="menu">
                        <a th:href="@{/admin/blogs}" class="item">管理博客</a>
                        <a th:href="@{/admin/logout}" class="item">注销</a>
                    </div>
                </div>
                <div  class="ui right-last stackable menu inverted secondary" th:if="${session.user} == null">
                    <a onclick="loginShow()" class="m_mobile_hide item">登陆</a>
                    <a onclick="registerShow()" class="m_mobile_hide item">注册</a>
                </div>
            </div>
            </div>

        </div>
    </div>
    <a class="ui menu toggle icon black button m_top_right m_mobile_show">
        <i class="sidebar icon"></i>
    </a>
</nav>




<div th:fragment="tools">
    <div class="ui tiny modal">
        <i class="close icon"></i>

        <div class="ui container">
            <br>
            <div class="header ui grid">
                <br>
                <div class="seven wide column"></div>
                <a id="login" onclick="login()"  href="javascript:void(0)"
                   class="two wide column m_font_big bottom_color">登陆</a>
                <a id="reg" onclick="regis()" href="javascript:void(0)" class="two wide column m_font_big">注册</a>
                <div class="five wide column"></div>

            </div>
        </div>
        <div class="ui inverted section m_margin_tb divider"></div>

        <div class="image  content">
            <div class="ui grid">
                <div class="ui seven wide column medium image">
                    <img th:src="@{/images/cat.gif}" width="250px">
                </div>
                <div class="ui one wide column"></div>
                <div class="ui eight wide column form">
                    <br>
                    <div id="nick"  style='width: 100%' class="ui field icon"></div>
                    <div style="width: 100%" class="field ui icon input">
                        <input type="text" name="email" placeholder="邮箱">
                        <i id="checkEmail" class=""></i>
                    </div>
                    <div style="width: 100%" class="field  ui icon input">
                        <input type="text" name="password" placeholder="密码(6-16位英文数字混合）">
                        <i id="checkPassword" class=""></i>
                    </div>
                    <div class="field">
                        <button class="ui button m_padded_small violet basic" id="loginBtn">登陆</button>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div class="m_padded m_fixed m_bottom_right">
        <div id="tools" class="ui  vertical  icon buttons" style="display:none;">
            <button class="ui icon button wx"><i class="weixin icon"></i></button>
            <a id="toTop" class="ui icon button"><i class="chevron up icon"></i></a>
        </div>
    </div>
    <div class="ui toc_container toc-con flowing popup  transition hidden" style="width: 250px">
        <ol class="js-toc">

        </ol>

    </div>
    <div id="qrcode" class="ui wx-con flowing popup m_padded_small transition hidden" style="width:100px">
        <!--<musicImg src="static/images/zfb.jpg"  class="ui  rounded bordered image"
             style="width: 90px;"
             alt="图片走丢了QWQ。"/>-->
    </div>
</div>


<footer th:fragment="footer" class="ui inverted vertical segment m_opacity_mini m_padded_tb_big">
    <!--创建容器 所有元素居中-->
    <div class="ui center aligned container">
        <!--将容器布局，分为16份，在每个div间加入竖线-->
        <div class="ui inverted divided stackable grid">
            <!--三份的列宽-->
            <div class="three wide column">
                <!--插入  圆角  图片-->
                <div class="ui inverted link list">
                    <div class="item">
                        <img class="ui rounded image" style="width: 110px" alt="图片走丢了QWQ。"
                             th:src="@{/images/wechat.png}">
                    </div>
                </div>
            </div>
            <div class="three wide column">
                <div class="ui inverted link list">
                    <h4 class="ui inverted header">每日一题</h4><br>
                    <p class="item ">是先有鸡还是先有蛋？</p>
                    <button id="answer" class="ui mini m_t_color_bottom m_t_bc_color_bottom   circular button">查看答案
                    </button>
                    <div class="ui checkAnswer flowing popup  transition hidden">
                        这是一个哲学的问题，按照正常定义指可以孵出鸡来的蛋也不一定就是先有蛋，根据表观遗传学生物可能在出生时为其它物种，但在后面进化为某种物种（具有遗传性）。
                    </div>
                </div>
            </div>
            <div class="three wide column">
                <div class="ui inverted link list">
                    <h4 class="inverted header ui">联系我</h4><br>
                    <p class="item m_opacity_mini" th:text="#{index.qq}"></p>
                    <p class="item m_opacity_mini" th:text="#{index.wx}"></p>

                </div>
            </div>
            <div class="seven wide column">
                <div class="ui inverted link list">
                    <h4 class="inverted header ui">博客简介</h4><br>
                    <p class="m_opacity_mini item">博客命名为Cealum，此单词有天空、月光之意。希望大家都能在这</p>
                    <p class="m_opacity_mini item">偌大的互联网中找到属于自己安静的一隅。</p>
                </div>
            </div>
        </div>
        <!--在页面底部增加一条横线-->
        <div class="ui inverted section divider"></div>
        <!--加入底部版权说明-->
        <p class="m_opacity_very_mini m_text_spaced">Copyright © 2020 Qiuzhijun All rights reserved</p>
    </div>

</footer>
<th:block th:fragment="script">
    <script th:src="@{/Semantic-UI-2.4.1/examples/assets/library/jquery.min.js}"></script>
    <script src="//cdn.jsdelivr.net/npm/jquery.scrollto@2.1.2/jquery.scrollTo.min.js"></script>
    <script th:src="@{/Semantic-UI-2.4.1/dist/semantic.min.js}"></script>
    <script th:src="@{/lib/prism/prism.js}"></script>
    <script th:src="@{/lib/tocbot/tocbot.min.js}"></script>
    <script th:src="@{/lib/qrcodejs/qrcode.min.js}"></script>
    <script th:src="@{/lib/waypoints/jquery.waypoints.min.js}"></script>
    <script th:src="@{/lib/line.js}"
            type="text/javascript"
            color="0,255,210" opacity="0.8"
            count="300"></script>
    <!--登陆、注册方法-->
    <script>

    window.onload
        //密码校验
        //密码(6-16的英文数字混合）
        var psdReg = /^(?![^a-zA-Z]+$)(?!\D+$)[0-9a-zA-Z]{6,16}$/;

        //email校验
        var emailReg =/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;

        //注册时输入昵称
        var regDiv = "<input type='text' name='nickname' placeholder='昵称'>" +
            " <i class='' id='checkNickname'></i>";

        var check = " x icon";

        function loginShow() {
            console.log("登陆")
            $('.ui.modal')
                .modal('show');
            login();


        }

        function registerShow() {
            console.log("注册")
            $('.ui.modal')
                .modal('show');
            regis();
        }

        function login() {
            $("#reg").removeClass("bottom_color");
            $("#login").addClass("bottom_color");
            $("#nick").removeClass("input");
            $("#nick").html("");
            $("#loginBtn").html("登陆")
        }

        function regis() {
            $("#login").removeClass("bottom_color");
            $("#reg").addClass("bottom_color");
            $("#nick").html(regDiv);
            $("#nick").addClass("input");

            $("#loginBtn").html("注册")
        }

        $("#loginBtn").click(function () {

            if($("#loginBtn").html() === "注册"){
                alert("敬请期待");
            }else{
                if(psdReg.test($("[name='password']").val()) && emailReg.test($("[name='email']").val())){
                    $.ajax({
                        url: "/blog/admin/login",
                        data: {
                            email : $("[name='email']").val(),
                            password :$("[name='password']").val()
                        },
                        dateType: "json",
                        type : "post",
                        success: function (resp) {
                            if(resp.username === undefined){
                                console.log("失败");
                            }
                            else{
                                $("#success").submit();
                            }
                        }
                    })
                }else{
                    console.log("校验失败");
                }
            }
        })
    $('.ui.dropdown').dropdown({
        on: 'hover'
    });

    </script>
</th:block>
</body>
</html>